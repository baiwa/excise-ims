<app-breadcrumb [route]="breadcrumb"></app-breadcrumb>

<!-- content -->
<div class="ui grid">
    <div class="sixteen wide column">

        <div class="ui top attached text-center header">
            <h4>เพิ่มเลขแบบพิมพ์</h4>
        </div>

        <!-- form add print no -->
        <div class="ui bottom attached segment">
            <div class="ui centered grid">
                <div class="fourteen wide column">
                    <form class="ui form" (submit)="addPrint($event)" #f="ngForm">
                        <div class="inline fields">
                            <div class="two wide field">
                                <label class="full-width text-right">
                                    เลขที่ใบอนุญาต
                                </label>
                            </div>
                            <div class="three wide field {{f.submitted && f.controls.permit_no.invalid ? 'error' : ''}}">
                                <div class="ui input">
                                    <input type="text" name="permit_no" class="full-width" ngModel required>
                                </div>
                            </div>
                            <div class="two wide field">
                                <label class="full-width text-right">
                                    เลขที่แบบพิมพ์
                                </label>
                            </div>
                            <div class="three wide field {{f.submitted && f.controls.print_no.invalid ? 'error' : ''}}">
                                <div class="ui input">
                                    <input type="text" name="print_no" class="full-width" ngModel required>
                                </div>
                            </div>
                            <div class="two wide field">
                                <label class="full-width text-right">
                                    จำนวนเงิน
                                </label>
                            </div>
                            <div class="three wide field {{f.submitted && f.controls.amount.invalid ? 'error' : ''}}">
                                <div class="ui input">
                                    <input type="text" name="amount" class="full-width" ngModel required>
                                </div>
                            </div>
                            <div class="one wide field">
                                <button class="ui mini primary button" type="submit">
                                    เพิ่ม / แก้ไข
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <!-- form add print no -->

        <div class="ui {{ (loading | async) ? 'loading' : '' }} top attached segment">
            <div class="ui grid">
                <div class="sixteen wide column">
                    <table id="table" class="ui celled nowrap striped table" style="width: 100%;">
                        <thead>
                            <tr class="center aligned">
                                <th rowspan="2">ลำดับที่</th>
                                <th rowspan="2">วันที่รับเงิน</th>
                                <th rowspan="2">วันที่นำฝากบัญชี</th>
                                <th rowspan="2">สินค้า/บริการ</th>
                                <th rowspan="2">รหัส</th>
                                <th rowspan="2">เลขแบบพิมพ์</th>
                                <th colspan="2">เลขใบเสร็จ </th>
                                <th rowspan="2">จำนวนเงิน</th>
                                <th rowspan="2">จำนวนเงิน(กรอก)</th>
                                <th rowspan="2">นำส่งมหาดไทย
                                    <br />10% / 98.5%</th>
                                <th rowspan="2">มหาดไทย
                                    <br />95% / 1.5%</th>
                                <th rowspan="2">เงินฝาก/ค่าใช้จ่าย
                                    <br />5% </th>
                                <th rowspan="2">รวม</th>
                                <th rowspan="2">ชดเชยกรมศุลฯ
                                    <br />0.75%</th>
                                <th rowspan="2">ค่าพิมพ์แสตมป์
                                    <br />1%</th>
                                <th rowspan="2">นำส่ง</th>
                                <!-- <th rowspan="2">Action</th> -->
                            </tr>
                            <tr class="center aligned">
                                <th>ชนิด</th>
                                <th>ลำดับ</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="text-center {{ data.status == 'diff' ? 'red' : '' }}" *ngFor="let data of taxReceipt | async; let i=index">
                                <td>{{ i + 1}}</td>
                                <td>{{ data.receiptDate ? dateFormat(data.receiptDate) : '-' }}</td>
                                <td>{{ data.depositDate ? dateFormat(data.depositDate) : '-' }}</td>
                                <td>{{ data.incomeName ? data.incomeName : '-' }}</td>
                                <td>{{ data.taxReceiptId ? data.taxReceiptId : '-' }}</td>
                                <td>{{ data.taxPrintNo && data.taxPrintNo != null ? data.taxPrintNo : '-' }}</td>
                                <td class="can-click" data-tooltip="คัดลอก" data-position="left center" (click)="selectValue(data.receiptNo)">{{ data.receiptNo ? data.receiptNo.split("/")[0] : '-' }}</td>
                                <td class="can-click" data-tooltip="คัดลอก" data-position="right center" (click)="selectValue(data.receiptNo)">{{ data.receiptNo ? data.receiptNo.split("/")[1] : '-' }}</td>
                                <td class="text-right">{{ round(data.netTaxAmount || 0.0) }}</td>
                                <td class="text-right">{{ round(data.checkedAmount || 0.0) }}</td>
                                <td class="text-right">{{ round(data.netLocAmount || 0.0) }}</td>
                                <td class="text-right">{{ round(data.locOthAmount || 0.0) }}</td>
                                <td class="text-right">{{ round(data.locExpAmount || 0.0) }}</td>
                                <td class="text-right">{{ round(data.sumAmount || 0.0) }}</td>
                                <td class="text-right">{{ round(data.customAmount || 0.0) }}</td>
                                <td class="text-right">{{ round(data.stampAmount || 0.0) }}</td>
                                <td class="text-right">{{ round(data.sendAmount || 0.0) }}</td>
                                <!-- <td style="text-align: center;">
                                    <button class="ui mini icon button" *ngIf="data.taxPrintNo" type="button" (click)="edit(i)">
                                        <i class="ui edit icon"></i>
                                    </button>
                                    <button class="ui mini icon button" *ngIf="data.taxPrintNo" type="button" (click)="del(i)">
                                        <i class="ui trash icon"></i>
                                    </button>
                                    <p *ngIf="!data.taxPrintNo">-</p>
                                </td> -->
                            </tr>
                        </tbody>
                        <tfoot>
                            <tr class="text-right">
                                <th rowspan="2">&nbsp;</th>
                                <th rowspan="2">&nbsp;</th>
                                <th rowspan="2">&nbsp;</th>
                                <th rowspan="2">&nbsp;</th>
                                <th rowspan="2">&nbsp;</th>
                                <th rowspan="2">&nbsp;</th>
                                <th colspan="2">รวม</th>
                                <th rowspan="2">{{ round(totalReceipt.netTaxAmount || 0.0) }}</th>
                                <th rowspan="2">{{ round(totalReceipt.checkedAmount || 0.0) }}</th>
                                <th rowspan="2">{{ round(totalReceipt.netLocAmount || 0.0) }}</th>
                                <th rowspan="2">{{ round(totalReceipt.locOthAmount || 0.0) }}</th>
                                <th rowspan="2">{{ round(totalReceipt.locExpAmount || 0.0) }}</th>
                                <th rowspan="2">{{ round(totalReceipt.netLocAmount || 0.0) }}</th>
                                <th rowspan="2">{{ round(totalReceipt.customAmount || 0.0) }}</th>
                                <th rowspan="2">{{ round(totalReceipt.stampAmount || 0.0) }}</th>
                                <th rowspan="2">{{ round(totalReceipt.sendAmount || 0.0) }}</th>
                                <!-- <th rowspan="2">&nbsp;</th> -->
                            </tr>
                            <tr style="display: none;">
                                <th>A</th>
                                <th>B</th>
                            </tr>
                        </tfoot>
                    </table>
                </div>
                <div class="sixteen wide center aligned column">
                    <a class="ui mini button widtd-100" routerLink='/int01/1/1'>
                        <i class="times left icon"></i>ยกเลิก
                    </a>
                    <button class="ui mini primary button widtd-100" (click)="saveAll()">
                        <i class="save icon"></i>บันทึก
                    </button>
                    <button class="ui mini primary button widtd-100">
                        <i class="print icon"></i>ส่งออก <!-- export -->
                    </button>
                    <a class="ui mini primary button widtd-100" routerLink='/int01/1/3'>
                        <i class="file alternate outline icon"></i>ตรวจสอบงบสรุปยอดภาษี
                    </a>
                </div>
            </div>
        </div>

    </div>
</div>
<!-- content -->

<!-- modal -->
<ui-modal [id]="'edit'" [size]="'large'" [type]="'custom'">
    <div class="header">แก้ไขข้อมูล</div>
    <div class="content">
        <form class="ui form" (submit)="updatePrint($event)" #fe="ngForm">
            <div class="inline fields">
                <div class="two wide field">
                    <label class="full-width text-right">
                        เลขที่ใบอนุญาต
                    </label>
                </div>
                <div class="three wide field {{fe.submitted && fe.controls.permit_no.invalid ? 'error' : ''}}">
                    <div class="ui input">
                        <input type="text" name="permit_no" class="full-width" ngModel required>
                    </div>
                </div>
                <div class="two wide field">
                    <label class="full-width text-right">
                        เลขที่แบบพิมพ์
                    </label>
                </div>
                <div class="three wide field {{fe.submitted && fe.controls.print_no.invalid ? 'error' : ''}}">
                    <div class="ui input">
                        <input type="text" name="print_no" class="full-width" ngModel required>
                    </div>
                </div>
                <div class="two wide field">
                    <label class="full-width text-right">
                        จำนวนเงิน
                    </label>
                </div>
                <div class="three wide field {{fe.submitted && fe.controls.amount.invalid ? 'error' : ''}}">
                    <div class="ui input">
                        <input type="text" name="amount" class="full-width" ngModel required>
                    </div>
                </div>
                <div class="one wide field">
                    <button class="ui mini primary button" type="submit">
                        แก้ไข
                    </button>
                </div>
            </div>
        </form>
    </div>
</ui-modal>
<!-- modal -->